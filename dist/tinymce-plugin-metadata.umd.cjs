(function(d){typeof define=="function"&&define.amd?define(d):d()})(function(){"use strict";const d=n=>i=>i.options.get(n),l=n=>{const i=n.options.register;i("metadata",{processor:"object[]"})},m=d("metadata"),r=n=>{const i=[],c={},s=m(n);if(s===void 0)throw Error("Metadata plugin not configured.");for(const a of s){const e=document.getElementById(a.id);if(e===null)throw Error(`Element '#${a.id}' not found.`);if(e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"&&e.nodeName!=="SELECT")throw Error(`Element '#${a.id}' must be a input, textarea or a select but is ${e.nodeName}.`);c[a.id]=e.value;const t={type:"input",name:a.id,label:a.label};if(e.nodeName==="INPUT"){const o=e;t.type="input",o.type==="checkbox"?(t.type="checkbox",c[a.id]=o.checked,t.checked=o.checked):o.type==="color"?t.type="colorinput":o.type==="range"&&(t.type="slider",c[a.id]=Number(e.value),t.min=Number(o.min),t.max=Number(o.max)),o.inputMode&&(t.inputMode=o.inputMode)}else if(e.nodeName==="TEXTAREA")t.type="textarea";else if(e.nodeName==="SELECT"){t.type="selectbox",t.items=[];for(const o of e.options)t.items.push({text:o.label,value:o.value})}e instanceof HTMLSelectElement&&e.disabled&&(t.enabled=!1),(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&((e.disabled||e.readOnly)&&(t.enabled=!1),e.placeholder&&(t.placeholder=e.placeholder)),i.push(t)}n.windowManager.open({title:"Metadata",size:"normal",body:{type:"panel",items:i},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:a=>{for(const e of s){const t=document.getElementById(e.id);t!==null&&(t.value=a.getData()[e.id],t.type=="checkbox"&&(t.checked=a.getData()[e.id]))}a.close()}})},u=n=>{n.addCommand("mceMetadata",()=>{r(n)})},p=n=>{const i=()=>n.execCommand("mceMetadata");n.ui.registry.addButton("metadata",{icon:"metadata",tooltip:"Edit metadata",onAction:i}),n.ui.registry.addIcon("metadata",'<svg height="24" width="24"><path d="M12 19 L19 5 L5 5 Z" /></svg>'),n.ui.registry.addMenuItem("metadata",{text:"Edit metadata",onAction:i})};(()=>{tinymce.PluginManager.add("metadata",n=>{u(n),l(n),p(n)})})()});
